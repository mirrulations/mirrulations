# S3 Structure

Within the bucket, *raw data* is the data obtained from the regulations.gov API and *derived data* is data generated by processing one or more raw data files.

The S3 bucket structure separates raw data from derived data.  Within each space data is organized by agency and docket id.  Within each docket, the binary data (attachments) are stored separately from the text data so that users can easily download only the text data.


```
s3://mirrulations
     ├── raw-data
     │   └── <agency>
     │       └── <docket id>
     │           ├── text-<docket id>
     │           │   ├── comments
     │           │   │   ├── <comment id>.json
     │           │   │   └── ...
     │           │   ├── docket
     │           │   │   ├── <docket id>.json
     │           │   │   └── ...
     │           │   └── documents
     │           │       ├── <document id>.json
     │           │       ├── <document id>_content.htm
     │           │       └── ...
     │           └── binary-<docket id>
     │               └── comments_attachments
     │                   ├── <comment id>_attachement_<counter>.<extension>
     │                   └── ...
     └── derived-data
         └── <agency>
             └── <docket id>
                 └── <organization>
                     └── <project name>
                         └── <file type>
                             └── <data file>
```

## Explanation of Raw Data Structure

**Key Points**:
 
1. **Agency-Level Organization**:
   - Data is grouped by the agency responsible for the docket.
2. **Docket-Level Organization**:
   - Each docket has its own directory, ensuring that all related files are stored together.
3. **Binary and Text Separation**:
   - Binary files (e.g., attachments) are stored in the `binary-<docket id>` directory.
   - Text-based files (e.g., JSON and HTML) are stored in the `text-<docket id>` directory.
4. **File Naming Conventions**:
   - Files are named systematically to ensure uniqueness and easy identification.


### **Level 1: `raw-data`**
- **Description**: The top-level directory that contains all raw data files.
- **Purpose**: Serves as the root directory for organizing data by agency and docket.

---

### **Level 2: `<agency>`**
- **Description**: Subdirectories under `raw-data` represent the government agency responsible for the data.
- **Example**: `EPA`, `FDA`, `USTR`.

---

### **Level 3: `<docket id>`**
- **Description**: Each agency directory contains subdirectories named after the docket IDs. A docket ID uniquely identifies a docket and its associated data.
- **Example**: `EPA-HQ-OPP-2011-0939`, `FDA-2017-D-2335`.

---

### **Level 4: `binary-<docket id>`**
- **Description**: This directory contains binary files (e.g., attachments) associated with the docket.
- **Subdirectories**:
  - **`comments_attachments`**:
    - Contains attachments related to comments.
    - **File Naming Convention**: `<comment id>_attachment_<counter>.<extension>`.
    - **Example**: `FDA-2017-D-2335-1566_attachment_1.pdf`.
  - **`documents_attachments`**:
    - Contains attachments related to documents.
    - **File Naming Convention**: `<document id>_attachment_<counter>.<extension>`.
    - **Example**: `FDA-2017-D-2335-0001_attachment_2.docx`.

---

### **Level 4: `text-<docket id>`**
- **Description**: This directory contains text-based files (e.g., JSON files) associated with the docket.
- **Subdirectories**:
  - **`comments`**:
    - Contains JSON files representing individual comments.
    - **File Naming Convention**: `<comment id>.json`.
    - **Example**: `FDA-2017-D-2335-1566.json`.
  - **`docket`**:
    - Contains JSON files representing the docket itself.
    - **File Naming Convention**: `<docket id>.json`.
    - **Example**: `FDA-2017-D-2335.json`.
  - **`documents`**:
    - Contains JSON files representing individual documents and their content.
    - **File Naming Convention**:
      - `<document id>.json`: Metadata for the document.
      - `<document id>_content.htm`: HTML content of the document.
    - **Examples**:
      - `FDA-2017-D-2335-0001.json`.
      - `FDA-2017-D-2335-0001_content.htm`.

---


## Explanation of Derived Data Structure

### **Level 1: `derived-data`**
- **Description**: The top-level directory that contains all derived data files.
- **Purpose**: Serves as the root directory for organizing data by agency and docket.

### **Level 2: `<agency>`**
- **Description**: Subdirectories under `derived-data` represent the government agency responsible for the data.
- **Purpose**: `EPA`, `FDA`, `USTR`.

### **Level 3: `<docket id>`**
- **Description**: Each agency directory contains subdirectories named after the docket IDs. A docket ID uniquely identifies a docket and its associated data.
- **Purpose**: `EPA-HQ-OPP-2011-0939`, `FDA-2017-D-2335`.

### **Level 4: `<organization>`**
- **Description**: Each docket-id directory contains subdirectories named after certain organizations. A organization uniquely identifies the associated data with that organization.
- **Purpose**: `mirrulations`, `MoravianResearch`.

### **Level 5: `<file type>`**
- **Description**: Each project will manipulate different files from the `raw_dat`.  Projects should use the same directory and naming structures
- **Purpose**: derived data should map to the original files by the folder and file name.  

### **Level 5: `<organization data>`**
- **Description**: Each docket-id directory contains subdirectories named after certain organizations. A organization uniquely identifies the associated derived data with that organization.
- **Purpose**: `ai_summary`, `entities`.